MikuMikuOnline 0.4.1 Build Rev.b77388e-Based WSS-Mod beta21  2021/10/03 by わしし

MMO公式より公開されている最終のdevelop版ソースRev.b77388eを元に
利用ライブラリを新しく＆個人的に変更したい点を一部改変したものになります

64Bit版も作成することが出来ましたので一緒に配布します
64Bit版では特に重たいモデルを複数出してもモデルが見えなくならない様です
(64Bit版は当然64BitOSを利用していないと動きません あしからず)

・配布ファイル
  client_wss-mod_beta21.exe    32Bit版
  client_wss-mod_beta21_64.exe 64Bit版
  config.json  クライアント設定ファイル(ロビーサーバの記述を変更)
  server.exe    自前ビルドのサーバ 32bit版
  server64.exe  自前ビルドのサーバ 64bit版
  server/config.json  サーバ設定ファイル(ロビーサーバの記述を変更)
  system/languages/jp.json 設定メニューファイル(日本語)
  system/languages/en.json 設定メニューファイル(英語)
  system/languages/jp.json.org (変更前のオリジナルのファイルのバックアップ )
  system/languages/en.json.org (変更前のオリジナルのファイルのバックアップ )
  system/plugins/modellist/main.js モデルリストのスクリプト
  system/plugins/modellist/main.js.org (変更前のオリジナルのファイルのバックアップ )
  system/js/sugar-1.4.1.min.js SugarJavaScriptライブラリ1.4.1
  unzip_sjis.exe 簡易zip解凍ソフト(日本語以外のWindowsで日本語を文字化けせずに解凍できます)

・利用方法
  改変したファイルのみの配布となりますので既存のMikuMikuOnlineクライアントの環境に
  アーカイブに含まれるexeファイルとsystemフォルダを既存のMikuMikuOnlineの環境に
  コピーしてこちらに含まれていたexeを起動して利用して下さい
  一部上書きになるファイルが有りますがそのまま上書きしてください
  (systemフォルダを上書きしないと起動エラーになります)

  環境を新規で作成する場合のおすすめは以下になります
      (詳細は各配布ファイルのreadmeファイル等を参照してください)

  １、公式のMikuMikuOnlineクライアントをダウンロードして展開
      http://sourceforge.jp/projects/mmo/downloads/57234/mmo-0.4.1_234.zip/

  ２、心経P配布の「MikuMikuOnline用Modクライアントパッケージ」をダウンロードして
      展開し公式クライアントを展開した場所に上書きコピー
      https://bowlroll.net/file/11998
      (心経P作成のMODクライアントとツール類、有志によるモデル等の同梱パッケージになります）

  ３、本アーカイブのファイルをMMOクライアントのフォルダに上書きコピーして
      client_wss-mod_beta21.exe(32Bit版)またはclient_wss-mod_beta21_64.exe(64Bit版)
      を起動するようにする
      ※MMOTalk(Modクライアントパッケージに同梱)を利用する場合は「MMO Client選択」で上記exe
        ファイルのどちらかを選択してください
      ※初回起動時はマップモデルのキャッシュファイルを作成するため接続画面がでるまで
        しばらくかかる場合があります、次回起動からは速くなります

・サーバの利用について
  こちらでビルドしたサーバプログラム server.exe,server64.exe を利用する場合は
  serverフォルダへ移動して利用してください
  　※server.exeはオリジナルと同名のため必要に応じて元のファイルをリネーム等してください
  なお改変クライアントは32bit,64bitどちらのクライアントでも32bitのserver.exeを起動します
  (64bitのserver64.exeは単独でサーバを起動する用途での利用を想定しています)


・公式クライアントからの変更点

NEW・Windows10で日本語入力がうまく行えない場合がある件の対応(IMEの不具合ぽいけど・・・)

NEW・DXライブラリの変更 3.22e

NEW・モデルロード中にウィンドウタイトルに "Loading..." の表示が出るように変更

NEW・Boostライブラリの変更 1.58.0（クライアント、サーバは互換性問題が出るので1.51.0のまま)

NEW・json生成時にモデルの読み込みに失敗した場合はjson生成等を行わないように修正(異常終了回避)

   ・V8 JavaScript Engine の変更 3.18

   ・json生成時に通常では削除できないフォルダ(フォルダ名の最後が'.')が作成されてしまうことが
     あるので修正

　 ・json生成時にアプリケーションエラーが発生する場合があるので修正   

   ・PMXモデルからのjson生成時にモデル名がUTF16で保存されている場合正常に生成できないのを修正

   ・json生成時にモーションファイル*.vmd)が含まれている場合はモデルと一緒にコピーされるように修正

   ・json生成時にモデルの高さを取得できなかった場合はheightを1.60とするように修正

   ・DXライブラリの最新化 3.12b→3.12f
     物理演算に不備があったためDXライブラリの最新化を保留していましたが物理演算を修正した3.12fが
     出たため変更

   ・日本語版以外のWindowsでスカイドームのテクスチャーファイルのファイル名が文字化けしていた場合に
     正常な名前にリネームする処理の対応言語追加(英語OSのみであったのをロシア語、ポルトガル語にも対応)

   ・上記の日本語版以外のWindowsでZIP展開時の文字化けについて言語毎に対応するのが困難なため、
　　 文字化けせずに展開できる簡易ZIP展開ツール unzip_sjis.exe を同梱
     日本語のWindows以外で日本語ファイル名を含むZIPファイルが文字化けする場合はこれを利用して
     展開してください(公式クライアントのzipやモデルのzip等)
     なお公式クライアントは日本語以外のWindowsで正常な日本語のファイルやフォルダがある場合は
     異常終了して使用できなくなりますので以降は改変クライアントを利用してください 

   ・PMX(2.0)のモデルもjsonを自動生成できるようにしました

   ・日本語版以外のWindowsでも動かしやすいようにしました
     ・日本語のフォルダやファイルがあっても異常終了しないように修正
     ・json生成時に日本語フォルダが文字化けしないで作成されるように修正
     ・スカイドームのテクスチャーファイルのファイル名が文字化けしていた場合正常な名前にリネームする 等

   ・カメラのズームが公式クライアントよりもアップにできます

   ・キャラクターの向きがちゃん送信及び反映されます(後ろ向きに歩いても他の人には前進に見えません)
     ただし旧クライアント利用時のキャラは反映されず状況によっては斜め歩きになります(制限事項w)

   ・ジャンプ以外もゲームパッドで行えるように修正、F1メニューの入力設定でボタン割り当て変更可能に
     (12ボタンまで対応、何番がどのボタンかわからない場合は入力設定画面でボタンを押してみてください)

   ・F1メニューの入力設定で 走る/歩く の切替方法の選択ができるようメニュー追加

   ・F1メニューの入力設定でゲームパッドの有効をウインドウアクティブ時のみに設定できるように修正

   ・新規モデルを追加して/reload で読み込んだ際そのモデルの利用者が前からいる場合もクライアントの
     再起動無しにモデルが見えるように修正

   ・心経P制作/配布のMODクライアントの機能を全て実装・・・のはず

   ・他の人のクライアントに出るログイン情報が???さんではなくちゃんと名前で出ます

   ・/nickコマンドで名前をつける際は32バイトまで付けれるのに最ログインすると
    16バイト以内の場合しか有効にならなかった不具合の修正
    ※全角1文字3バイト(UNICODE)､半角1文字1バイトの様です

   ・ウィンドウが画面外に出てしまって戻せない場合にF2キーを押してアイコン収納、復帰すること
     により初期位置、初期サイズに戻ります

   ・チャンネル移動時にユーザモデルデータ、ワープオブジェクト、スカイドームを解放しないように
     したので今までのクライアントより高速にチャンネル移動できます
     (ユーザモデルデータはサーバ上の全チャンネルで利用者が居なくなった時点で解放されます)

   ・ロビーサーバの名前解決に失敗しても異常終了しないようにしたので全くネットがない環境でも
     ローカルサーバに接続して利用可能
     また今までプログラムに埋め込みでしたがconfig.jsonのロビーサーバの設定も参照するように変更
     (但し m2op.net はドメインがmmo関係者の物ではなくなっている為設定されていても除外しています)

   ・DXライブラリの最新化に伴い以下の点が改善
     ・Intel CPU コードネームHaswellの内蔵グラフィックによる動作が可能(HaswellRefreshについては現在未確認)
     ・Windows8でMMOクライアントが非アクティブでもキー入力が効いてしまっていたのの改善
     ・Windows8でIMEでの入力時に未確定状態の文字が見えないことがあるのの改善
     ・flyのモーション等をさせた際に地面に伸びていた紐？がでなくなった
     ・ステージ 空色町ver1.52の読み込みに60分以上かかっていたのが改善(DXライブラリ3.12b)

   ・Javaスクリプトエンジンのバージョンを出すinfo()でクラッシュしてたのの改善

   ・ソケットインタフェース切断後ソケットに出力しようとしてもクラッシュしないように修正

   ・/reload で新規モデル読み込み時に既にそのモデルになっていたユーザもモデル反映するように修正


・その他注意点

   ・初回起動時はステージのMV1変換が再度動きますので接続画面が出るまで少し時間がかかります

   ・DxLibの仕様変更によりモデルの見え方や物理演算の挙動が異なるかもしれません

   ・個人的に改変したものですので公式Twitterやニコ動の公式コミュ等での質問等はお避けください

   ・最悪アプリケーションエラーが発生するかもしれません あしからずw



・MikuMikuOnline 公式ソース
  http://sourceforge.jp/projects/mmo/scm/git/main/commits

・内包ライブラリのバージョンは以下の通り
  ・DXライブラリ 3.22e
    https://dxlib.xsrv.jp/

  ・V8 JavaScript Engine 3.18
    https://code.google.com/p/v8/
    (http://v8.googlecode.com/svn/branches/3.18/)

  ・boost C++ライブラリ 1.58.0 (クライアント)
    boost C++ライブラリ 1.51.0 (サーバ ※これ以降は互換性問題が出る)
    http://www.boost.org/

  ・Crypto++ Library 5.6.2
    http://www.cryptopp.com/

  ・Sugar Javascript library 1.4.1
    http://sugarjs.com/


・改版履歴

  ・2021/10/03 beta21
    ・Windows10 IMEでうまく動かない場合がある件対応
    ・モデルロード中をウインドウタイトルに表示
    ・DXライブラリの最新化 3.13c→3.22e
    ・Boostライブラリの更新 1.57.0→1.58.0
    ・設定ファイル config.json のロビーサーバの記述を変更

  ・2014/12/24 beta20
    ・DXライブラリの最新化 3.13→3.13c(12/23版)
      (DXライブラリに起因するjpeg読み込み失敗の解消)
    ・Boostライブラリの最新化 1.56.0→1.57.0
    ・V8 JavaScript Engine の最新化 3.15 → 3.18
    ・Sugar javaScript Library の最新化 1.3.5 → 1.4.1
    ・このバージョンより名称をWSS-Modとする、それに伴うウインドウタイトルやexe名等の変更

  ・2014/11/01 beta19
    ・json生成時にモデル名によっては通常では削除できないフォルダ(名前の最後が.で終わるフォルダ)を
      作成してしまうので修正

  ・2014/10/22 beta18
    ・json生成時にアプリケーションエラーが出る場合があるので修正

  ・2014/10/19 beta17
    ・DXライブラリの最新化 3.12f→3.13
    ・Boostライブラリの最新化 1.55.0→1.56.0
    ・PMXファイルからのjson生成でPMXファイルをバイナリーモードで読み込んでいなかったため
      一部モデル名の取得に失敗し正常にjson生成ができなかったのを修正
    ・json生成時にモーションファイル(*.vmd)が含まれていても移行先フォルダにコピーされず
      消えてしまっていたので一緒にコピーされるように修正
    ・json生成時にモデルの高さが取得できない場合height値が0.00にになるのを1.60とするよう修正
    ・存在しておらず、また使用していないイメージファイル gui_icon_base_close.png を読まないように修正

  ・2014/09/24 beta16
    ・DXライブラリの最新化 3.12b→3.12f(09/24配布版)

  ・2014/08/23 beta15
    ・スカイドームのテクスチャーファイルがzip展開時に文字化けしていた場合は修正する処理で
      英語のWindowsしか対応していなかったのをロシア語、ポルトガル語を追加
    ・上記処理の言語毎の対応が困難なため文字化けせずzip展開できる簡易ZIP展開ツールunzip_sjis.exeを同梱

  ・2014/08/16 beta14
    ・json生成時にPMX(2.0)ファイルもjson生成できるように修正
    ・json生成時にテクスチャーがサブフォルダーにある場合フォルダを作成するように修正
    ・他国語OS対応強化
      ・Shift_JIS ←→ utf8の文字コード変換でCP_ACP(OSのデフォルトコードページ)が指定されていたところを
        932(日本語Shift_JIS)に変更
      ・スカイドームのテクスチャーファイルがzip展開時に文字化けしていた場合は修正する処理を追加
      ・json生成時にフォルダーを作成する際のフォルダ名をUNICODEで指示するように修正
    ・DXLib 3.12c,3.12dが出てたけど物理演算の挙動がなぜか異なるので3.12bのまま保留

  ・2014/08/03 beta13
    ・まだWindowsXpの環境でウインドウ非アクティブ時にもマウスが効く場合があったので効かないように修正
    ・json生成時に「モデル名:作者名」が長い場合に文字を削るように修正
    ・Pキーでスクリーンショットを採取した際のメッセージをprivate相当に修正
    ・スカイドームのマテリアル選択を名称からインデックス数値に変換していたところを直接数値指定に変更

  ・2014/07/21 beta12
    ・WindowsXpの環境でウインドウ非アクティブ時にもマウスが効く場合があるので効かないように修正
    ・チャットウインドウでチャット内容に改行がある場合にそれ以降の行の折り返し位置がおかしくなるのを修正

  ・2014/07/21 beta12
    ・WindowsXpの環境でウインドウ非アクティブ時にもマウスが効く場合があるので効かないように修正
    ・チャットウインドウでチャット内容に改行がある場合にそれ以降の行の折り返し位置がおかしくなるのを修正

  ・2014/07/14 beta11
    ・WindowsXpの環境でウインドウ非アクティブ時にもキー入力が効く場合があるので効かないように修正

  ・2014/07/06 beta10
    ・カメラのズームをキャラクターにカメラが当たった後は視野角を狭くすることにより更にズームできるように修正
    ・F10キーを押した際にウインドウ標準メニューが出てしまう場合があるのを出ないように修正
    ・F1メニューの「その他」タブをキャラクター読み込みの非同期処理がうまくいかないため封印ｗ

  ・2014/06/01 beta9a
    ・NPCクライアントでNPCを移動した際の角度情報が常に0設定されているようで斜め歩きになってしまうので
      修正(角度のテーブルの0を245に変更 角度テーブルにある値だと角度として採用するようにしているため)
      
  ・2014/06/01 beta9
    ・モデルの向きを送信、反映されるように修正
    ・DXライブラリのバージョンを3.12bに変更、それによりステージ：空色町ver1.52の読み込み高速化

  ・2014/04/14 beta8
    ・モデルの読み込みを一部非同期に切り替えれるように修正したがバグがある模様
    ・前回追加したゲームパッドのアクティブ時の有効で起動時に前回終了時の設定が反映されていない為修正
    ・Pキーでスクリーンショットを採取した際にチャットウインドウにメッセージが出るように修正
    ・ゲームパッドのボタンで操作できるものを追加、また割り当ても変更できるように修正(M,P,SHIFTを追加)

  ・2014/03/16 beta7
    ・ソケットインタフェース切断後ソケットに出力しようとしてもクラッシュしないように修正
    ・/reload で新規モデル読み込み時に既にそのモデルになっていたユーザもモデル反映するように修正
    ・DXライブラリを3.11eに変更
    ・ソケットインタフェース利用時に切断等でソケットの書き込みに失敗した場合は以降書き込まないように修正
      (チャンネル移動時に異常終了しにくくなるはず)
    ・F1→入力設定メニューでウインドウアクティブ時のみゲームパッド有効にも設定できるように修正

  ・2014/03/02 beta6
    ・DXライブラリ 3.11dがリリースされていたのでこちらを使用するように変更
    ・クライアント起動時に既にローカルでサーバが立ち上がっている場合でも新たにサーバを立ち上げ
      ようとしてサーバの起動エラーが出ていたため既に立ち上がっている場合は立ち上げないように修正
    ・MMOインストール先の.\models\キャラクター フォルダ直下にモデルデータがあっても
      キャラクター フォルダが消えてしまわないように修正
    ・チャンネル移動時のモデル解放を修正しサーバ上で使われているユーザモデルおよびワープオブジェクト、
      スカイドームのモデルについては解放しないように変更
    ・チャンネル移動時に他チャンネルで利用中のモデルは解放しないようにした影響で他チャンネルにいる
      モデルも描画されてしまったため描画されないように修正
    ・チャンネル移動時に他チャンネルで利用中のモデルは解放しないようにした影響でミニマップに他チャン
      ネルにいるユーザも表示されていたため表示されないように修正

  ・2014/01/27 beta5
    ・心経PのMODクライアントの機能を全て実装完了・・・多分
    ・config.json のlobby_serversの設定を参照するように修正
      jsonに記載されたサーバに順次接続施行して繋がればそこを利用します
      但しm2op.netは現在はドメインがmmopの物ではなくなっているため指定されても利用しない
      jsonに記載されたサーバ全てに接続できない場合はデフォルトサーバへ接続施行します
      ※現状ロビーサーバは存在しないので何も変わりませんｗ
    ・コンパイル時の最適化オプションを変更(主に 32Bit:サイズ優先 64Bit:速度優先 でコンパイル)
    ・コンパイルオプションの浮動小数点の処理タイプを高速版にしてビルドしたところキャラが見えたり
      見えなくなったりしてハマるｗ

  ・2014/01/19 beta4
    ・ログイン情報で名前がちゃんと出せるように修正
    ・終了時j保存された名前が次の起動時に有効にならない不具合修正
    ・モデルロードに失敗した際にDxLibがダンプしないように修正
    ・Javaスクリプトエンジンのバージョンを出すinfo()を行った際に例外で落ちないように修正

  ・2014/01/17 beta3
    ・ロビーサーバのホスト名が名前解決できない場合でも異常終了しないように修正
      (全くネットがない環境でもローカルで利用可能になります)
    ・ステージデータのMV1形式キャッシュの座標精度をMODクライアントと同じ32bitに変更
    ・ウインドウが画面外に出てしまった際にF2キーを押してアイコン収納、復帰で初期位置
      初期サイズに戻るように変更

  ・2014/01/12 beta2
    ・V8 JavaScriptエンジンを3.13.7からソース変更なしで使える範囲での最新3.15.11に変更
    ・ロビーサーバの変更を忘れていたので修正(m2op.net→z.moe.hm)
      今はm2op.netドメインが売れた様で他のWebが出るからそのままでも動いていたようですw
    ・64Bit版がビルドできたので同梱

  ・2014/01/09 beta
    ・とりあえず動くようになったので配布

